pkgname=cairo
pkgver=2.0.0
release=rc4
pkgrel=1
epoch=
pkgdesc="Cairo language installation"
arch=("x86_64")
url="https://cairo-by-example/"
license=('MIT')
groups=()
depends=("git" "rustup")
makedepends=()
checkdepends=()
optdepends=()
provides=()
conflicts=()
replaces=()
backup=()
options=()
install=
changelog=
source=("https://github.com/starkware-libs/$pkgname/archive/refs/tags/v$pkgver-$release.tar.gz")
noextract=()
md5sums=()
validpgpkeys=()
sha256sums=("e3dd3ce3f9ab5b69c44d01b13777d92516dcd830efb6a3d2cd46915d4f03e8a9")
prepare() {
	rustup override set stable
	rustup update
}

build() {
	cd "$pkgname-$pkgver-$release"
	cargo build --all --release --manifest-path ./Cargo.toml
	
}

package() {
	# todo: make a for loop that searches for executable files, and moves them.
	
	pwd
	echo $pkgdir
	mkdir -p $pkgdir/usr/bin/
	mv $pkgname-$pkgver-$release/target/release/cairo-run $pkgdir/usr/bin/
	mv $pkgname-$pkgver-$release/target/release/cairo-compile $pkgdir/usr/bin
	mv $pkgname-$pkgver-$release/target/release/cairo-format $pkgdir/usr/bin
	mv $pkgname-$pkgver-$release/target/release/cairo-language-server $pkgdir/usr/bin
	mv $pkgname-$pkgver-$release/target/release/cairo-test $pkgdir/usr/bin
	mv $pkgname-$pkgver-$release/target/release/sierra-compile $pkgdir/usr/bin
	mv $pkgname-$pkgver-$release/target/release/starknet-compile $pkgdir/usr/bin
	mv $pkgname-$pkgver-$release/target/release/starknet-sierra-compile $pkgdir/usr/bin
}

